<div class="p-4 md:p-6">
  <div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-800 mb-2">Inventory Management</h1>
    <p class="text-gray-600">Manage your jewelry items and stock</p>
  </div>

  <p-card>
    <!-- Filters Section -->
    <div class="mb-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Search -->
        <div>
          <label for="search" class="block text-sm font-medium text-gray-700 mb-2"> Search </label>
          <div class="relative w-full">
            <i class="pi pi-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            <input
              pInputText
              id="search"
              type="text"
              [(ngModel)]="filters.search"
              (keyup.enter)="onSearch()"
              placeholder="Search by name, code, or HUID"
              class="w-full pl-10"
            />
          </div>
        </div>

        <!-- Category Filter -->
        <div>
          <label for="category" class="block text-sm font-medium text-gray-700 mb-2">
            Category
          </label>
          <input
            pInputText
            id="category"
            type="text"
            [(ngModel)]="filters.category"
            (input)="onCategoryChange()"
            placeholder="Search by category"
            class="w-full"
          />
        </div>
      </div>

      <!-- Actions Row -->
      <div class="mt-4 flex justify-end gap-2">
        <p-button
          icon="pi pi-filter-slash"
          (onClick)="clearFilters()"
          [outlined]="true"
          severity="secondary"
          pTooltip="Clear Filters"
          tooltipPosition="top"
        ></p-button>
        <p-button
          icon="pi pi-plus"
          label="Add Item"
          (onClick)="onAddItem()"
          severity="primary"
          styleClass="hidden sm:inline-flex"
        ></p-button>
        <p-button
          icon="pi pi-plus"
          (onClick)="onAddItem()"
          severity="primary"
          styleClass="sm:hidden"
          pTooltip="Add Item"
          tooltipPosition="top"
        ></p-button>
      </div>
    </div>

    <!-- Mobile Card View -->
    <div class="md:hidden space-y-3">
      <!-- Loading Skeleton -->
      <div *ngIf="loading" class="space-y-3">
        <div
          *ngFor="let i of [1, 2, 3, 4, 5]"
          class="bg-white border border-gray-200 rounded-lg p-4 shadow-sm"
        >
          <p-skeleton width="40%" height="1.5rem" styleClass="mb-2"></p-skeleton>
          <p-skeleton width="80%" height="1rem" styleClass="mb-3"></p-skeleton>
          <div class="flex justify-between items-center">
            <p-skeleton width="30%" height="1rem"></p-skeleton>
            <p-skeleton width="25%" height="2rem"></p-skeleton>
          </div>
        </div>
      </div>

      <!-- Items Cards -->
      <div *ngIf="!loading && items.length > 0" class="space-y-3">
        <div
          *ngFor="let item of items"
          class="bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <div class="font-bold text-indigo-600 text-sm mb-1">{{ item.itemCode }}</div>
              <div class="font-semibold text-gray-800 text-lg">{{ item.name }}</div>
            </div>
          </div>

          <div class="grid grid-cols-2 gap-3 text-sm mb-3">
            <div>
              <span class="text-gray-500 block">Category</span>
              <span class="inline-block bg-gray-100 px-2 py-1 rounded text-xs mt-1">{{
                item.category
              }}</span>
            </div>
            <div>
              <span class="text-gray-500 block">HUID</span>
              <span class="font-medium">{{ item.huid }}</span>
            </div>
            <div>
              <span class="text-gray-500 block">Gross Wt.</span>
              <span class="font-medium">{{ item.grossWeight }}g</span>
            </div>
            <div>
              <span class="text-gray-500 block">Net Wt.</span>
              <span class="font-medium">{{ item.netWeight }}g</span>
            </div>
          </div>

          <div class="flex justify-end gap-2 pt-3 border-t border-gray-100">
            <p-button
              icon="pi pi-pencil"
              label="Edit"
              (onClick)="onEditItem(item)"
              [outlined]="true"
              severity="info"
              size="small"
            ></p-button>
            <p-button
              icon="pi pi-trash"
              label="Delete"
              (onClick)="onDeleteItem(item)"
              [outlined]="true"
              severity="danger"
              size="small"
            ></p-button>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!loading && items.length === 0" class="text-center py-12">
        <i class="pi pi-inbox text-6xl text-gray-300 mb-4 block"></i>
        <p class="text-lg text-gray-500 mb-2">No items found</p>
        <p class="text-sm text-gray-400">Try adjusting your filters or add a new item</p>
      </div>

      <!-- Mobile Pagination -->
      <div
        *ngIf="!loading && items.length > 0"
        class="flex justify-between items-center pt-4 border-t"
      >
        <span class="text-sm text-gray-600">
          Showing {{ items.length }} of {{ totalRecords }} items
        </span>
      </div>
    </div>

    <!-- Desktop Table View -->
    <p-table
      [value]="loading ? skeletonItems : items"
      [paginator]="true"
      [rows]="filters.limit || 10"
      [totalRecords]="totalRecords"
      [lazy]="false"
      (onPage)="onPageChange($event)"
      [rowsPerPageOptions]="[10, 25, 50]"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} items"
      styleClass="p-datatable-sm hidden md:block"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="itemCode" class="whitespace-nowrap">
            Item Code
            <p-sortIcon field="itemCode"></p-sortIcon>
          </th>
          <th pSortableColumn="category" class="hidden sm:table-cell whitespace-nowrap">
            Category
            <p-sortIcon field="category"></p-sortIcon>
          </th>
          <th pSortableColumn="name" class="whitespace-nowrap">
            Name
            <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th class="hidden md:table-cell whitespace-nowrap">HUID</th>
          <th class="hidden lg:table-cell whitespace-nowrap">Gross Wt.</th>
          <th class="hidden lg:table-cell whitespace-nowrap">Net Wt.</th>
          <th class="whitespace-nowrap">Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item>
        <tr *ngIf="!loading">
          <td class="whitespace-nowrap">
            <span class="font-medium text-indigo-600">{{ item.itemCode }}</span>
          </td>
          <td class="hidden sm:table-cell">
            <span class="text-sm bg-gray-100 px-2 py-1 rounded whitespace-nowrap">{{
              item.category
            }}</span>
          </td>
          <td>
            <div>
              <div class="font-medium">{{ item.name }}</div>
              <div class="text-xs text-gray-500 sm:hidden mt-1">
                <span class="inline-block bg-gray-100 px-2 py-1 rounded mr-2">{{
                  item.category
                }}</span>
              </div>
              <div class="text-xs text-gray-500 md:hidden mt-1">HUID: {{ item.huid }}</div>
            </div>
          </td>
          <td class="hidden md:table-cell whitespace-nowrap">
            <span class="text-sm text-gray-600">{{ item.huid }}</span>
          </td>
          <td class="hidden lg:table-cell whitespace-nowrap">{{ item.grossWeight }}g</td>
          <td class="hidden lg:table-cell whitespace-nowrap">{{ item.netWeight }}g</td>
          <td class="whitespace-nowrap">
            <div class="flex gap-1">
              <p-button
                icon="pi pi-pencil"
                (onClick)="onEditItem(item)"
                [text]="true"
                severity="info"
                size="small"
                pTooltip="Edit"
                tooltipPosition="top"
              ></p-button>
              <p-button
                icon="pi pi-trash"
                (onClick)="onDeleteItem(item)"
                [text]="true"
                severity="danger"
                size="small"
                pTooltip="Delete"
                tooltipPosition="top"
              ></p-button>
            </div>
          </td>
        </tr>
        <tr *ngIf="loading">
          <td><p-skeleton width="80%"></p-skeleton></td>
          <td class="hidden sm:table-cell"><p-skeleton width="60%"></p-skeleton></td>
          <td><p-skeleton width="90%"></p-skeleton></td>
          <td class="hidden md:table-cell"><p-skeleton width="70%"></p-skeleton></td>
          <td class="hidden lg:table-cell"><p-skeleton width="50%"></p-skeleton></td>
          <td class="hidden lg:table-cell"><p-skeleton width="50%"></p-skeleton></td>
          <td><p-skeleton width="60%"></p-skeleton></td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="7" class="text-center py-8">
            <div class="text-gray-400">
              <i class="pi pi-inbox text-4xl mb-3"></i>
              <p class="text-lg">No items found</p>
              <p class="text-sm">Try adjusting your filters or add a new item</p>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>

  <p-confirmDialog></p-confirmDialog>
</div>
